var jsonPlus={title:"jsonPlus",version:"v1.0",options:{mode:"parse"},isfuncDesc:new RegExp("^(( *)function( *)((.*))( *))$"),isfuncAnonymous:new RegExp("^(( *)function( *)anonymous((.*))( *))"),number:"(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",oneChar:'(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',funcdef:"(?:_[0-9])",escapeSequence:new RegExp("\\\\(?:([^u])|u(.{4}))","g"),escapes:{'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},EMPTY_STRING:new String(""),SLASH:"\\",firstTokenCtors:{"{":Object,"[":Array},hop:Object.hasOwnProperty,unescapeOne:function(a,b,c){return b?escapes[b]:String.fromCharCode(parseInt(c,16))},reverse:function(a){return a.split("").reverse().join("")},trim:function(b){b=b.replace(/^\s+/,"");for(var a=b.length-1;a>=0;a--){if(/\S/.test(b.charAt(a))){b=b.substring(0,a+1);break}}return b},get:function(c,b){if(b){this.extendOptions(b)}var a=this.ajax.get(c);return this.parse(a)},parse:function(b,a){if(a){this.extendOptions(a)}var c=this.validate(b);if(c.valid==true){switch(this.options.mode){case"eval":return this.evalObject(b);break;case"parse":default:return this.parsePlus(b);break}}else{return{error:c.error}}},stringify:function(a,b){if(b){this.extendOptions(b)}return this.stringifyObj(a)},extend:function(a,b){return this.deepExtend(a,b)},extendOptions:function(a){this.options=this.deepExtend(this.options,a)},validate:function(h){var b=0;var k="";var a=0;var l;var m;var n=false;var e=this.trim(h).split("\n");var d=e.length;if(e[0].charAt(0)!="{"){return{valid:false,error:"Error at Line: 1: Object must start with curly bracket"}}else{for(var g=0;g<d;g++){var c=e[g].length;if(c>0){for(var f=0;f<c;f++){if(e[g].charAt(f)=="{"){b++;n=true;l=g;m=f+1}if(e[g].charAt(f)=="}"){b--;n=true;l=g;m=f+1}if(b==0&&n==true){a++}n=false;if(b<0){k="Error at Line: "+(g+1)+", char: "+(f+1)}if(b>0&&f>=c-1){k="Error at Line: "+(g+1)+", char: "+(f+1)}if(a>1){k="Error: only one object is allowed, counted: "+a}}}}if(b==0&&a==1){return{valid:true,error:k}}else{return{valid:false,error:k}}}},isFuncDeclared:function(d){var b=d.length;var a="";if(b>0){for(i=d.length;i>=0;i--){if(d.charAt(i)==":"){break}else{a+=d.charAt(i)}}}var c=this.reverse(a);var e=c.match(this.isfuncDesc);if(e!=null){return e[0]}else{return false}},parseFunc:function(g){var a=0;var b=new Array();var f=new Array();var k=new Array();var l={};var c=g.length;for(var e=0;e<c;e++){if(g.charAt(e)=="{"){a++;k[a]=this.isFuncDeclared(g.substring(0,e))}if(a>0){for(var d=1;d<=a;d++){if(!b[d]){b[d]=""}if(k[d]!=false){b[d]+=g.charAt(e)}}}if(g.charAt(e)=="}"){if(k[a]!=false){f[f.length]=k[a]+b[a]}b[a]="";k[a]=false;a--}}for(item in f){var h="_"+item;l[h]=f[item];g=g.replace(f[item],h)}return new Array(g,l)},evalObject:function(c){var a="var tmpObj="+c;a=a.replace("\n","");try{this.globalEvalx(a)}catch(b){var d=b}return d},globalEvalx:function(src){if(window.execScript){window.execScript(src);return}var fn=function(){window.eval.call(window,src)};fn()},stringifyObj:function(c,e){var b=[],a;for(var d in c){if(c.hasOwnProperty(d)){if(e===true){a=""}else{a='"'+d+'":'}switch(typeof c[d]){case"object":if(c[d] instanceof Array){a+=this.stringify(c[d],true)}else{a+=this.stringify(c[d],false)}break;case"function":a+=this.cleanFunction(c[d].toString());break;case"string":a+='"'+c[d]+'"';break;case"number":a+=c[d];break;case"boolean":a+=c[d];break;default:a+=c[d]}b.push(a)}}if(e===true){return"["+b.join()+"]"}else{return"{"+b.join()+"}"}},deepExtend:function(c,b){for(var a in b){if(!c[a]){c[a]={}}switch(typeof b[a]){case"object":if(b[a] instanceof Array){c[a]=b[a]}else{c[a]=this.deepExtend(c[a],b[a])}break;default:c[a]=b[a];break}}return c},createFunction:function(d){var c=d.match(/\((.*?)\)/);var b=d.match(/{[^{]+({[^{}]+?}[^{]+)*[^}]+}/);var a=b[0].substr(1,b[0].length-2);return new Function(c[0].substr(1,c[0].length-2),a)},cleanFunction:function(a){var b=a.match(this.isfuncAnonymous);if(b){return a.replace(/( *)anonymous\(/,"(")}else{return a}},parsePlus:function(b){var l=this.parseFunc(b);var k=l[0];var j=l[1];var d=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+this.funcdef+"|"+this.number+'|(?:"'+this.oneChar+'*"))',"g");var f=k.match(d);var p={};var m=f[0];var a=false;var h;var g=[p];var c=f.length;for(var e=1-a;e<c;++e){m=f[e];var o;switch(m.charCodeAt(0)){default:o=g[0];o[h||o.length]=+(m);h=void 0;break;case 34:m=m.substring(1,m.length-1);if(m.indexOf(this.SLASH)!==-1){m=m.replace(this.escapeSequence,this.unescapeOne)}o=g[0];if(!h){if(o instanceof Array){h=o.length}else{h=m||this.EMPTY_STRING;break}}o[h]=m;h=void 0;break;case 95:o=g[0];o[h||o.length]=this.createFunction(j[m]);h=void 0;break;case 91:o=g[0];g.unshift(o[h||o.length]=[]);h=void 0;break;case 93:g.shift();break;case 102:o=g[0];o[h||o.length]=false;h=void 0;break;case 110:o=g[0];o[h||o.length]=null;h=void 0;break;case 116:o=g[0];o[h||o.length]=true;h=void 0;break;case 123:o=g[0];g.unshift(o[h||o.length]={});h=void 0;break;case 125:g.shift();break}}if(a){if(g.length!==1){throw new Error()}p=p[0]}else{if(g.length){throw new Error()}}return p},ajax:{x:function(){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){return new XMLHttpRequest()}}},nocache:function(a){a.setRequestHeader("Cache-Control","no-cache");a.setRequestHeader("If-Modified-Since","Wed, 31 Dec 1980 00:00:00 GMT");a.setRequestHeader("Expires","Wed, 31 Dec 1980 00:00:00 GMT")},get:function(a){var b=jsonPlus.ajax.gets(a);return b},gets:function(b,c){var a=jsonPlus.ajax.x();a.open("GET",b,false);a.send(null);return a.responseText},json:function(url){var jstr=jsonPlus.ajax.gets(url);return eval("("+jstr+")")},send:function(e,g,c,d,h){var b=jsonPlus.ajax.x();b.open(c,e,true);b.onreadystatechange=function(){if(b.readyState==4){g(b.responseText)}};if(c=="POST"){b.setRequestHeader("Content-type","application/x-www-form-urlencoded")}if(h){jsonPlus.ajax.nocache(b)}b.send(d);return b.responseText},post:function(b,c,a){jsonPlus.ajax.send(b,c,"POST",a)}}};